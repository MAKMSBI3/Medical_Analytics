{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-09-28T13:36:45.125491Z", "invocation_id": "8ddbe747-2519-4551-8319-62c228b382f1", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:39.756442Z", "completed_at": "2025-09-28T13:36:39.775418Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:39.813659Z", "completed_at": "2025-09-28T13:36:40.542678Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.8050334453582764, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7d3-0000-00104c8ea271"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.bronze_billing", "compiled": true, "compiled_code": "\n\nSELECT\n  billing_id,\n  appointment_id,\n  patient_id,\n  total_amount,\n  insurance_paid,\n  patient_paid,\n  billing_date,\n  payment_status,\n  insurance_claim_number,\n  created_at,\n  created_at AS updated_at,\n  CURRENT_TIMESTAMP() AS dbt_loaded_at,\n  '8ddbe747-2519-4551-8319-62c228b382f1' AS dbt_batch_id\nFROM MEDICAL_DB.RAW.billing\nWHERE billing_id IS NOT NULL", "relation_name": "MEDICAL_DB.bronze.bronze_billing", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:39.742687Z", "completed_at": "2025-09-28T13:36:39.768353Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:39.768353Z", "completed_at": "2025-09-28T13:36:40.547719Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8100812435150146, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7f6-0000-00104c8e9401"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.bronze_appointments", "compiled": true, "compiled_code": "\n\nSELECT\n  appointment_id,\n  patient_id,\n  doctor_id,\n  appointment_date,\n  appointment_type,\n  status,\n  duration_minutes,\n  notes,\n  created_at,\n  created_at AS updated_at,\n  CURRENT_TIMESTAMP() AS dbt_loaded_at,\n  '8ddbe747-2519-4551-8319-62c228b382f1' AS dbt_batch_id\nFROM MEDICAL_DB.RAW.appointments\nWHERE appointment_id IS NOT NULL", "relation_name": "MEDICAL_DB.bronze.bronze_appointments", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:39.762688Z", "completed_at": "2025-09-28T13:36:39.774415Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:39.808931Z", "completed_at": "2025-09-28T13:36:40.650222Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.9105825424194336, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7f6-0000-00104c8e9405"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.bronze_doctors", "compiled": true, "compiled_code": "\n\nSELECT\n  doctor_id,\n  doctor_name,\n  specialty,\n  department_id,\n  phone,\n  email,\n  license_number,\n  years_experience,\n  is_active,\n  hired_date,\n  CURRENT_TIMESTAMP() AS dbt_loaded_at,\n  '8ddbe747-2519-4551-8319-62c228b382f1' AS dbt_batch_id\nFROM MEDICAL_DB.RAW.doctors\nWHERE doctor_id IS NOT NULL", "relation_name": "MEDICAL_DB.bronze.bronze_doctors", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:40.563678Z", "completed_at": "2025-09-28T13:36:40.575640Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:40.576640Z", "completed_at": "2025-09-28T13:36:41.075383Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.518458366394043, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7f5-0000-00104c8e8421"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.bronze_patients", "compiled": true, "compiled_code": "\n\nSELECT\n  patient_id,\n  first_name,\n  last_name,\n  date_of_birth,\n  gender,\n  blood_type,\n  phone,\n  email,\n  address,\n  city,\n  state,\n  zip_code,\n  insurance_type,\n  emergency_contact,\n  created_at,\n  created_at AS updated_at,\n  CURRENT_TIMESTAMP() AS dbt_loaded_at,\n  '8ddbe747-2519-4551-8319-62c228b382f1' AS dbt_batch_id\nFROM MEDICAL_DB.RAW.patients\nWHERE patient_id IS NOT NULL", "relation_name": "MEDICAL_DB.bronze.bronze_patients", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:40.556924Z", "completed_at": "2025-09-28T13:36:40.569995Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:40.571504Z", "completed_at": "2025-09-28T13:36:41.113432Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5596942901611328, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7f5-0000-00104c8e841d"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.bronze_medical_records", "compiled": true, "compiled_code": "\n\nSELECT\n  record_id,\n  appointment_id,\n  patient_id,\n  diagnosis,\n  treatment_plan,\n  prescription,\n  follow_up_required,\n  severity,\n  created_at,\n  created_at AS updated_at,\n  CURRENT_TIMESTAMP() AS dbt_loaded_at,\n  '8ddbe747-2519-4551-8319-62c228b382f1' AS dbt_batch_id\nFROM MEDICAL_DB.RAW.medical_records\nWHERE record_id IS NOT NULL", "relation_name": "MEDICAL_DB.bronze.bronze_medical_records", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:40.657839Z", "completed_at": "2025-09-28T13:36:40.663762Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:40.664272Z", "completed_at": "2025-09-28T13:36:41.212607Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5568606853485107, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7d3-0000-00104c8ea275"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.silver_billing", "compiled": true, "compiled_code": "\n\nSELECT\n  billing_id,\n  appointment_id,\n  patient_id,\n  total_amount,\n  insurance_paid,\n  patient_paid,\n  ROUND((insurance_paid / NULLIF(total_amount, 0)) * 100, 2) AS insurance_coverage_percentage,\n  CASE \n    WHEN total_amount >= 1000 THEN 'High Value'\n    WHEN total_amount >= 500 THEN 'Medium Value'\n    ELSE 'Low Value' END AS revenue_tier,\n  CASE \n    WHEN (insurance_paid / NULLIF(total_amount, 0)) >= 0.9 THEN 'Excellent Coverage'\n    WHEN (insurance_paid / NULLIF(total_amount, 0)) >= 0.7 THEN 'Good Coverage'\n    WHEN (insurance_paid / NULLIF(total_amount, 0)) >= 0.5 THEN 'Fair Coverage'\n    ELSE 'Poor Coverage' END AS coverage_quality,\n  billing_date,\n  DATEDIFF('day', billing_date, CURRENT_DATE()) AS days_since_billing,\n  payment_status,\n  CASE \n    WHEN payment_status = 'Paid' THEN 'Collected'\n    WHEN payment_status = 'Pending' THEN 'Outstanding'\n    WHEN payment_status = 'Denied' THEN 'Collection'\n    ELSE 'Review' END AS collection_status,\n  CASE WHEN payment_status != 'Paid' AND DATEDIFF('day', billing_date, CURRENT_DATE()) > 30 THEN 1 ELSE 0 END AS is_overdue,\n  insurance_claim_number,\n  created_at,\n  updated_at,\n  dbt_loaded_at,\n  dbt_batch_id\nFROM MEDICAL_DB.bronze.bronze_billing\nWHERE billing_id IS NOT NULL", "relation_name": "MEDICAL_DB.silver.silver_billing", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:41.082893Z", "completed_at": "2025-09-28T13:36:41.088435Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:41.089435Z", "completed_at": "2025-09-28T13:36:41.636970Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5550878047943115, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7d3-0000-00104c8ea279"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.silver_appointments", "compiled": true, "compiled_code": "\n\nSELECT\n  appointment_id,\n  patient_id,\n  doctor_id,\n  appointment_date,\n  DATE(appointment_date) AS appointment_date_only,\n  TIME(appointment_date) AS appointment_time,\n  EXTRACT(HOUR FROM appointment_date) AS appointment_hour,\n  DAYNAME(appointment_date) AS day_of_week,\n  CASE WHEN DAYNAME(appointment_date) IN ('Saturday','Sunday') THEN 'Weekend' ELSE 'Weekday' END AS day_type,\n  CASE \n    WHEN EXTRACT(HOUR FROM appointment_date) BETWEEN 6 AND 11 THEN 'Morning'\n    WHEN EXTRACT(HOUR FROM appointment_date) BETWEEN 12 AND 17 THEN 'Afternoon'\n    WHEN EXTRACT(HOUR FROM appointment_date) BETWEEN 18 AND 21 THEN 'Evening'\n    ELSE 'After Hours' END AS time_slot,\n  appointment_type,\n  status,\n  CASE WHEN status = 'Completed' THEN 1 ELSE 0 END AS is_completed,\n  CASE WHEN status = 'No-Show' THEN 1 ELSE 0 END AS is_no_show,\n  CASE WHEN status = 'Cancelled' THEN 1 ELSE 0 END AS is_cancelled,\n  duration_minutes,\n  CASE \n    WHEN duration_minutes <= 15 THEN 'Short'\n    WHEN duration_minutes <= 45 THEN 'Standard'\n    ELSE 'Extended' END AS duration_category,\n  notes,\n  created_at,\n  updated_at,\n  dbt_loaded_at,\n  dbt_batch_id\nFROM MEDICAL_DB.bronze.bronze_appointments\nWHERE appointment_id IS NOT NULL", "relation_name": "MEDICAL_DB.silver.silver_appointments", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:41.218762Z", "completed_at": "2025-09-28T13:36:41.227498Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:41.228499Z", "completed_at": "2025-09-28T13:36:41.681659Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4638974666595459, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7f6-0000-00104c8e9409"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.silver_patients", "compiled": true, "compiled_code": "\n\nSELECT\n  patient_id,\n  TRIM(UPPER(first_name)) AS first_name,\n  TRIM(UPPER(last_name)) AS last_name,\n  TRIM(UPPER(first_name)) || ' ' || TRIM(UPPER(last_name)) AS full_name,\n  date_of_birth,\n  \n  DATEDIFF('year', date_of_birth, CURRENT_DATE())\n AS age,\n  \n  CASE\n    WHEN \n  DATEDIFF('year', date_of_birth, CURRENT_DATE())\n < 18 THEN 'Minor'\n    WHEN \n  DATEDIFF('year', date_of_birth, CURRENT_DATE())\n BETWEEN 18 AND 39 THEN 'Young Adult'\n    WHEN \n  DATEDIFF('year', date_of_birth, CURRENT_DATE())\n BETWEEN 40 AND 59 THEN 'Middle Age'\n    WHEN \n  DATEDIFF('year', date_of_birth, CURRENT_DATE())\n BETWEEN 60 AND 79 THEN 'Senior'\n    ELSE 'Elderly'\n  END\n AS age_group,\n  CASE WHEN \n  DATEDIFF('year', date_of_birth, CURRENT_DATE())\n >= 65 THEN 'Senior' ELSE 'Non-Senior' END AS senior_status,\n  UPPER(gender) AS gender,\n  blood_type,\n  CASE \n    WHEN blood_type IN ('O+','O-') THEN 'Universal Donor'\n    WHEN blood_type IN ('AB+','AB-') THEN 'Universal Recipient'\n    ELSE 'Standard' END AS blood_type_category,\n  phone,\n  LOWER(TRIM(email)) AS email,\n  address,\n  TRIM(UPPER(city)) AS city,\n  UPPER(state) AS state,\n  zip_code,\n  insurance_type,\n  CASE \n    WHEN insurance_type IN ('Medicare','Medicaid') THEN 'Government'\n    WHEN insurance_type = 'Private' THEN 'Commercial'\n    ELSE 'Other' END AS insurance_category,\n  emergency_contact,\n  created_at,\n  updated_at,\n  dbt_loaded_at,\n  dbt_batch_id\nFROM MEDICAL_DB.bronze.bronze_patients\nWHERE patient_id IS NOT NULL", "relation_name": "MEDICAL_DB.silver.silver_patients", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:41.118491Z", "completed_at": "2025-09-28T13:36:41.123528Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:41.125043Z", "completed_at": "2025-09-28T13:36:41.737671Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6201858520507812, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7d3-0000-00104c8ea27d"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.silver_doctors", "compiled": true, "compiled_code": "\n\nWITH specialty_mapping AS (\n  SELECT * FROM MEDICAL_DB.reference.medical_specialties\n)\nSELECT\n  d.doctor_id,\n  TRIM(d.doctor_name) AS doctor_name,\n  TRIM(d.specialty) AS specialty,\n  COALESCE(sm.specialty_category,'Other') AS specialty_category,\n  d.department_id,\n  d.phone,\n  LOWER(TRIM(d.email)) AS email,\n  d.license_number,\n  d.years_experience,\n  CASE \n    WHEN d.years_experience < 5 THEN 'Junior'\n    WHEN d.years_experience BETWEEN 5 AND 15 THEN 'Mid-Level'\n    WHEN d.years_experience BETWEEN 16 AND 25 THEN 'Senior'\n    ELSE 'Expert' END AS experience_level,\n  CASE \n    WHEN d.specialty IN ('Emergency Medicine','Surgery') THEN 'Critical Care'\n    WHEN d.specialty IN ('Cardiology','Neurology','Oncology') THEN 'Specialty Care'\n    WHEN d.specialty IN ('Internal Medicine','Pediatrics') THEN 'Primary Care'\n    ELSE 'Other Care' END AS care_category,\n  d.is_active,\n  CASE WHEN d.is_active = 'Y' THEN TRUE ELSE FALSE END AS is_active_flag,\n  d.hired_date,\n  DATEDIFF('year', d.hired_date, CURRENT_DATE()) AS tenure_years,\n  d.dbt_loaded_at,\n  d.dbt_batch_id\nFROM MEDICAL_DB.bronze.bronze_doctors d\nLEFT JOIN specialty_mapping sm ON d.specialty = sm.specialty_name\nWHERE d.doctor_id IS NOT NULL", "relation_name": "MEDICAL_DB.silver.silver_doctors", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:41.644308Z", "completed_at": "2025-09-28T13:36:41.651805Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:41.652864Z", "completed_at": "2025-09-28T13:36:42.162829Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5200293064117432, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7f6-0000-00104c8e940d"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.silver_medical_records", "compiled": true, "compiled_code": "\n\nWITH diagnosis_mapping AS (\n  SELECT * FROM MEDICAL_DB.reference.diagnosis_codes\n)\nSELECT\n  mr.record_id,\n  mr.appointment_id,\n  mr.patient_id,\n  TRIM(mr.diagnosis) AS diagnosis,\n  COALESCE(dm.diagnosis_category,'Other') AS diagnosis_category,\n  COALESCE(dm.icd_10_code,'Unknown') AS icd_10_code,\n  TRIM(mr.treatment_plan) AS treatment_plan,\n  CASE \n    WHEN mr.treatment_plan = 'Medication' THEN 'Pharmacological'\n    WHEN mr.treatment_plan IN ('Surgery','Procedure') THEN 'Surgical'\n    WHEN mr.treatment_plan IN ('Physical Therapy','Counseling') THEN 'Therapeutic'\n    ELSE 'Conservative' END AS treatment_category,\n  mr.prescription,\n  mr.follow_up_required,\n  CASE WHEN mr.follow_up_required = 'Y' THEN 1 ELSE 0 END AS needs_follow_up,\n  mr.severity,\n  CASE \n    WHEN mr.severity = 'Low' THEN 1\n    WHEN mr.severity = 'Medium' THEN 2\n    WHEN mr.severity = 'High' THEN 3\n    ELSE 0 END AS severity_score,\n  mr.created_at,\n  mr.updated_at,\n  mr.dbt_loaded_at,\n  mr.dbt_batch_id\nFROM MEDICAL_DB.bronze.bronze_medical_records mr\nLEFT JOIN diagnosis_mapping dm ON mr.diagnosis = dm.diagnosis_name\nWHERE mr.record_id IS NOT NULL", "relation_name": "MEDICAL_DB.silver.silver_medical_records", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:41.688158Z", "completed_at": "2025-09-28T13:36:41.694150Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:41.695372Z", "completed_at": "2025-09-28T13:36:42.214769Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5285911560058594, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7f5-0000-00104c8e8425"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.dim_patients", "compiled": true, "compiled_code": "\n\nSELECT\n  patient_id,\n  first_name,\n  last_name,\n  full_name,\n  date_of_birth,\n  age,\n  age_group,\n  senior_status,\n  gender,\n  blood_type,\n  blood_type_category,\n  city,\n  state,\n  insurance_type,\n  insurance_category,\n  emergency_contact,\n  created_at AS patient_since,\n  DATEDIFF('day', created_at, CURRENT_DATE()) AS days_as_patient,\n  CURRENT_TIMESTAMP() AS last_updated\nFROM MEDICAL_DB.silver.silver_patients", "relation_name": "MEDICAL_DB.gold.dim_patients", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:41.742846Z", "completed_at": "2025-09-28T13:36:41.748367Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:41.748367Z", "completed_at": "2025-09-28T13:36:42.256965Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5147593021392822, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7d3-0000-00104c8ea281"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.dim_doctors", "compiled": true, "compiled_code": "\n\nSELECT\n  doctor_id,\n  doctor_name,\n  specialty,\n  specialty_category,\n  experience_level,\n  care_category,\n  years_experience,\n  tenure_years,\n  is_active_flag,\n  hired_date,\n  CURRENT_TIMESTAMP() AS last_updated\nFROM MEDICAL_DB.silver.silver_doctors", "relation_name": "MEDICAL_DB.gold.dim_doctors", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:42.265496Z", "completed_at": "2025-09-28T13:36:42.276425Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:42.277435Z", "completed_at": "2025-09-28T13:36:42.945605Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6842212677001953, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7f5-0000-00104c8e8429"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.fact_appointments", "compiled": true, "compiled_code": "\n\nSELECT \n  a.appointment_id,\n  a.patient_id,\n  a.doctor_id,\n  a.appointment_date,\n  a.appointment_date_only,\n  a.day_of_week,\n  a.day_type,\n  a.time_slot,\n  a.appointment_type,\n  a.status,\n  a.is_completed,\n  a.is_no_show,\n  a.is_cancelled,\n  a.duration_minutes,\n  a.duration_category,\n  -- Patient context\n  p.age_group AS patient_age_group,\n  p.insurance_category AS patient_insurance_category,\n  p.senior_status AS patient_senior_status,\n  -- Doctor context\n  d.specialty AS doctor_specialty,\n  d.experience_level AS doctor_experience_level,\n  d.care_category AS doctor_care_category,\n  -- Business metrics (illustrative)\n  CASE \n    WHEN a.appointment_type = 'Emergency' THEN 500\n    WHEN a.appointment_type = 'Surgery' THEN 2000\n    WHEN a.appointment_type = 'Consultation' THEN 200\n    WHEN a.appointment_type = 'Follow-up' THEN 100\n    WHEN a.appointment_type = 'Screening' THEN 150\n    ELSE 175 END AS estimated_revenue,\n  a.created_at,\n  CURRENT_TIMESTAMP() AS last_updated\nFROM MEDICAL_DB.silver.silver_appointments a\nLEFT JOIN MEDICAL_DB.gold.dim_patients p ON a.patient_id = p.patient_id\nLEFT JOIN MEDICAL_DB.gold.dim_doctors d ON a.doctor_id = d.doctor_id", "relation_name": "MEDICAL_DB.gold.fact_appointments", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:42.970269Z", "completed_at": "2025-09-28T13:36:42.978662Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:42.984744Z", "completed_at": "2025-09-28T13:36:43.746601Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.7879064083099365, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7d3-0000-00104c8ea289"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.fact_medical_outcomes", "compiled": true, "compiled_code": "\n\nSELECT \n  mr.record_id,\n  mr.appointment_id,\n  mr.patient_id,\n  mr.diagnosis,\n  mr.diagnosis_category,\n  mr.treatment_plan,\n  mr.treatment_category,\n  mr.severity,\n  mr.severity_score,\n  mr.needs_follow_up,\n  -- Appointment context\n  a.appointment_date,\n  a.appointment_type,\n  a.doctor_id,\n  -- Patient context\n  p.age_group AS patient_age_group,\n  p.senior_status AS patient_senior_status,\n  -- Doctor context\n  d.specialty AS treating_specialty,\n  d.care_category AS treating_care_category,\n  -- Risk assessment\n  CASE \n    WHEN mr.severity = 'High' AND p.age >= 65 THEN 'Critical Risk'\n    WHEN mr.severity = 'High' OR p.age >= 75 THEN 'High Risk'\n    WHEN mr.severity = 'Medium' AND p.age >= 50 THEN 'Moderate Risk'\n    ELSE 'Low Risk' END AS patient_risk_level,\n  mr.created_at,\n  CURRENT_TIMESTAMP() AS last_updated\nFROM MEDICAL_DB.silver.silver_medical_records mr\nLEFT JOIN MEDICAL_DB.gold.fact_appointments a ON mr.appointment_id = a.appointment_id\nLEFT JOIN MEDICAL_DB.gold.dim_patients p ON mr.patient_id = p.patient_id\nLEFT JOIN MEDICAL_DB.gold.dim_doctors d ON a.doctor_id = d.doctor_id", "relation_name": "MEDICAL_DB.gold.fact_medical_outcomes", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:42.961704Z", "completed_at": "2025-09-28T13:36:42.977664Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:42.978662Z", "completed_at": "2025-09-28T13:36:43.784399Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.8277575969696045, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7d3-0000-00104c8ea285"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.fact_billing", "compiled": true, "compiled_code": "\n\nSELECT \n  b.billing_id,\n  b.appointment_id,\n  b.patient_id,\n  b.total_amount,\n  b.insurance_paid,\n  b.patient_paid,\n  b.insurance_coverage_percentage,\n  b.revenue_tier,\n  b.coverage_quality,\n  b.payment_status,\n  b.collection_status,\n  b.is_overdue,\n  b.days_since_billing,\n  -- Appointment context\n  a.appointment_date,\n  a.appointment_type,\n  a.time_slot,\n  a.doctor_id,\n  -- Patient context\n  p.insurance_category AS patient_insurance_category,\n  p.age_group AS patient_age_group,\n  -- Doctor context\n  d.specialty AS service_specialty,\n  d.care_category AS service_care_category,\n  b.created_at,\n  CURRENT_TIMESTAMP() AS last_updated\nFROM MEDICAL_DB.silver.silver_billing b\nLEFT JOIN MEDICAL_DB.gold.fact_appointments a ON b.appointment_id = a.appointment_id\nLEFT JOIN MEDICAL_DB.gold.dim_patients p ON b.patient_id = p.patient_id\nLEFT JOIN MEDICAL_DB.gold.dim_doctors d ON a.doctor_id = d.doctor_id", "relation_name": "MEDICAL_DB.gold.fact_billing", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:43.795770Z", "completed_at": "2025-09-28T13:36:43.809271Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:43.810507Z", "completed_at": "2025-09-28T13:36:44.337000Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5451171398162842, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7f6-0000-00104c8e9411"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.kpi_dashboard", "compiled": true, "compiled_code": "\n\nWITH appt AS (\n  SELECT \n    COUNT(*) AS total_appointments,\n    SUM(CASE WHEN is_completed = 1 THEN 1 ELSE 0 END) AS completed_appointments,\n    SUM(CASE WHEN is_no_show = 1 THEN 1 ELSE 0 END) AS no_shows\n  FROM MEDICAL_DB.gold.fact_appointments\n),\nrev AS (\n  SELECT \n    SUM(total_amount) AS total_revenue,\n    SUM(patient_paid) AS total_patient_paid,\n    SUM(insurance_paid) AS total_insurance_paid\n  FROM MEDICAL_DB.gold.fact_billing\n)\nSELECT \n  a.total_appointments,\n  a.completed_appointments,\n  a.no_shows,\n  ROUND(a.no_shows * 100.0 / NULLIF(a.total_appointments, 0), 2) AS no_show_rate_pct,\n  r.total_revenue,\n  r.total_patient_paid,\n  r.total_insurance_paid,\n  CURRENT_DATE() AS kpi_as_of_date\nFROM appt a CROSS JOIN rev r", "relation_name": "MEDICAL_DB.gold.kpi_dashboard", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-28T13:36:43.801465Z", "completed_at": "2025-09-28T13:36:43.814549Z"}, {"name": "execute", "started_at": "2025-09-28T13:36:43.815594Z", "completed_at": "2025-09-28T13:36:44.608029Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.8144941329956055, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf5a90-3201-f7f6-0000-00104c8e9415"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.medical_project.patient_summary", "compiled": true, "compiled_code": "\n\nWITH agg AS (\n  SELECT \n    p.patient_id,\n    COUNT(DISTINCT a.appointment_id) AS total_appointments,\n    COUNT(DISTINCT CASE WHEN a.is_completed = 1 THEN a.appointment_id END) AS completed_appointments,\n    COUNT(DISTINCT CASE WHEN a.is_no_show = 1 THEN a.appointment_id END) AS no_show_count,\n    COUNT(DISTINCT mr.record_id) AS total_diagnoses,\n    COUNT(DISTINCT mr.diagnosis) AS unique_diagnoses,\n    COUNT(DISTINCT CASE WHEN mr.severity = 'High' THEN mr.record_id END) AS high_severity_cases,\n    COUNT(DISTINCT CASE WHEN mr.needs_follow_up = 1 THEN mr.record_id END) AS follow_ups_needed,\n    COALESCE(SUM(b.total_amount), 0) AS lifetime_revenue,\n    COALESCE(SUM(b.patient_paid), 0) AS total_patient_payments,\n    COALESCE(SUM(b.insurance_paid), 0) AS total_insurance_payments,\n    COALESCE(AVG(b.insurance_coverage_percentage), 0) AS avg_insurance_coverage,\n    MAX(a.appointment_date) AS last_visit_date,\n    MIN(a.appointment_date) AS first_visit_date\n  FROM MEDICAL_DB.gold.dim_patients p\n  LEFT JOIN MEDICAL_DB.gold.fact_appointments a ON p.patient_id = a.patient_id\n  LEFT JOIN MEDICAL_DB.silver.silver_medical_records mr ON p.patient_id = mr.patient_id\n  LEFT JOIN MEDICAL_DB.gold.fact_billing b ON p.patient_id = b.patient_id\n  GROUP BY 1\n)\nSELECT \n  p.patient_id,\n  p.full_name,\n  p.age,\n  p.age_group,\n  p.insurance_category,\n  a.total_appointments,\n  a.completed_appointments,\n  a.no_show_count,\n  ROUND(a.no_show_count * 100.0 / NULLIF(a.total_appointments, 0), 2) AS no_show_rate,\n  a.total_diagnoses,\n  a.unique_diagnoses,\n  a.high_severity_cases,\n  a.follow_ups_needed,\n  a.lifetime_revenue,\n  a.total_patient_payments,\n  a.total_insurance_payments,\n  a.avg_insurance_coverage,\n  a.last_visit_date,\n  a.first_visit_date,\n  DATEDIFF('day', a.first_visit_date, a.last_visit_date) AS patient_journey_days,\n  CURRENT_TIMESTAMP() AS last_updated\nFROM MEDICAL_DB.gold.dim_patients p\nLEFT JOIN agg a ON p.patient_id = a.patient_id", "relation_name": "MEDICAL_DB.gold.patient_summary", "batch_results": null}], "elapsed_time": 6.610134840011597, "args": {"write_json": true, "introspect": true, "warn_error_options": {"include": [], "exclude": []}, "indirect_selection": "eager", "log_level": "info", "favor_state": false, "vars": {}, "macro_debugging": false, "populate_cache": true, "log_file_max_bytes": 10485760, "version_check": true, "skip_nodes_if_on_run_start_fails": false, "print": true, "quiet": false, "require_resource_names_without_spaces": false, "send_anonymous_usage_stats": true, "log_format": "default", "partial_parse_file_diff": true, "require_nested_cumulative_type_params": false, "profiles_dir": "C:\\Users\\ADMIN\\.dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "source_freshness_run_project_hooks": false, "project_dir": "C:\\Users\\ADMIN\\dbt_core\\medical_project", "strict_mode": false, "exclude": [], "state_modified_compare_vars": false, "defer": false, "cache_selected_only": false, "require_batched_execution_for_custom_microbatch_strategy": false, "show_resource_report": false, "static_parser": true, "use_colors": true, "log_level_file": "debug", "invocation_command": "dbt run", "log_path": "C:\\Users\\ADMIN\\dbt_core\\medical_project\\logs", "partial_parse": true, "printer_width": 80, "which": "run", "log_format_file": "debug", "state_modified_compare_more_unrendered_values": false, "use_colors_file": true, "select": [], "require_yaml_configuration_for_mf_time_spines": false, "empty": false}}